#!/usr/bin/env ruby
require 'benchmark'
require File.expand_path(File.join(File.dirname(__FILE__), %w[.. lib devlog.rb]))
USAGE= <<-EOF
#{Devlog.display_version}
This software is intended to parse and present information within devlog.markdown development logs.

#{'Use it as You'.green} #{'dodo'.pur}.

Using with a file:

  #{'devlog'.red} /path/to/devlog.markdown

or just in a folder with a 'devlog.markdown' file:

  #{'devlog'.green} 

EOF
#arguments
$:.unshift File.join(File.dirname(__FILE__))
@in_file = ARGV[0]
def print_usage
  puts USAGE
end
def dodo
  include Devlog
  time = Benchmark.realtime do 
    if @in_file
      puts "Parsing #{@in_file}...".red
      t = parse_devlog_now(@in_file)
      puts t.validation_string
      puts t.to_info_string
    else
      puts "Parsing devlog.markdown in current folder...".green
      t = parse_devlog_now("devlog.markdown") #try default file
      puts t.validation_string
      puts t.to_info_string
    end
 end
 puts "\nRealtime used : #{time}sec\n\n"
end

begin

  if ARGV.size > 0
    dodo
  else
      dodo
  end

rescue
    print_usage
end

#exit
